<!DOCTYPE html>
<html>
<head>
	<link href="/static/css/strapdown.css" rel="stylesheet">
	<link href="/static/css/united.min.css" rel="stylesheet">
	<link href="/static/css/bootstrap-responsive.min.css" rel="stylesheet">
</head>
<title>订单</title>
<xmp theme="united" style="display:none;">
## 获取订单详情
### 接口地址
    GET: /mall/order/
### 必要参数
```
access_token: 访问令牌
order_id: 订单编号
```
### 返回数据
#### 请求成功
```
{
    "order_id": "20160308135616870",
    "order_status": 3,
    "sub_orders": [
        {
            "order_id": "20161009220753655^3s",
            "order_status": 3,
            "postage": 10,
            "delivery_time": "",
            "express_company_name": "",
            "express_number": "",
            "products": [
                {
                    "product_id": 3,
                    "price": 50,
                    "product_name": "商品1",
                    "product_model_name": "standard",
                    "product_count": 1,
                    "pic_url": "http://chaozhi.weizoom.comlove.png"
                }
            ]
        },
        {
            "order_id": "20161009220753655^4s",
            "order_status": 3,
            "postage": 0,
            "delivery_time": "",
            "express_company_name": "",
            "express_number": "",
            "products": [
                {
                    "product_id": 4,
                    "price": 50,
                    "product_name": "商品2",
                    "product_model_name": "standard",
                    "product_count": 1,
                    "pic_url": "http://chaozhi.weizoom.comlove.png"
                }
            ]
        }
    ],
    "products": [
        {
            "product_count": 1,
            "product_name": "商品1",
            "price": 50,
            "product_model_name": "standard",
            "product_id": 3
        },
        {
            "product_count": 1,
            "product_name": "商品2",
            "price": 50,
            "product_model_name": "standard",
            "product_id": 4
        }
    ],
    "final_price": 100,
    "postage": 10,
    "ship_name": "张三",
    "ship_address": "张三的地址",
    "ship_area": "北京市 北京市 海淀区",
    "ship_tel": "13766665555",
    "created_at": "2016-10-09 22:07:53"
}
```
#### 请求失败
```
{
    "code": 200,
    "data": {
        "errcode": 72000,
        "errmsg":"获取订单详情请求参数错误或缺少参数"
    },
    "errMsg": "",
    "innerErrMsg": ""
}
```
### 字段说明
```
order_id: 订单编号（其中包含'^'字符和后缀是子订单的编号）。
order_status: 订单状态：
        值为0，表示待支付；
        值为1，表示已取消；
        值为3，表示待发货；
        值为4，表示已发货；
        值为5，表示已完成；
        值为6或者8，表示退款中；
        值为7或者9，表示退款完成。
sub_orders：子订单的详细信息。其中包含，子订单编号
order_id；子订单状态
order_status；子订单运费
postage；发货时间
delivery_time；快递公司名称
express_company_name；快递单号
express_number；子订单包含的商品products。
products：订单的商品信息。其中包含：
          商品id，product_id；
          商品名称product_name；
          商品价格price；
          商品数量product_count；
          商品规格product_model_name。
final_price：订单总金额。
postage：订单总运费。
ship_name：收货人姓名。
ship_address：收获人详细地址。
ship_area: 收货人的省市区编码表参考“地址区域”接口描述中的json文件。
ship_tel：收货人电话。
created_at：订单创建时间。
```
### order_detail文件下载
[order_detail.json文件地址](http://dev.poseidon.com/static/wiki/order_detail.json)

## 创建订单的参数和地址
### 接口地址
    POST: /mall/order/?_method=put
### 必要参数
    access_token: 访问令牌
    deal_id: 交易流水号:第三方创建出订单的订单号，唯一
    ship_name: 收货人姓名
    ship_tel: 收货人电话
    ship_address: 收货人地址
    area: 收货人省市县3级，例如1_1_8，代表的是北京市 北京市 海淀区，编码表参考“地址区域”接口描述中的json文件
    products: 商品集合,一条商品信息包含商品ID+商品规格名+商品数量，
            如：[{"product_id":25232,"product_model_name":"10:14","product_count":1,},....]
### 例如
```
{
    "access_token": "/oZ%2B%2BmPtgmDPNtr5UP0mBfWq7Sey1Z66L2%2BHG7nRLzAuObp7MyYdp3Sv7Fx33/gvY%2BRskIet1zoleyLqabDuNiWesdEak4FtPJ8KD5M8IVoMMZjbrWmWzTrYa/ucG4e3",
    "deal_id": "1476669901123428",
    "ship_name": "bill",
    "ship_tel": "18612187381",
    "ship_address": "中关村南大街海淀科技大厦",
    "area": "1_1_8",
    "products": [
        {
            "product_id":12,
            "product_model_name":"standard",
            "product_count":1
        }
    ]
}
```

### 返回数据
#### 请求成功
> 成功，返回订单编号（order_id）。

```
{
    "code": 200,
    "data": {
        "order_id": "20160927152821329"
    },
    "errMsg": "",
    "innerErrMsg": ""
}
```

#### 请求失败
> 失败，返回错误代码（errcode）和错误信息（errmsg）.

```
{
    {
        "code": 200,
        "data": {
            "errcode": 71000,
            "errmsg":"创建订单请求中有商品库存不足"
        },
        "errMsg": "",
        "innerErrMsg": ""
    }
}
```
### 创建订单参数文件下载
[put_order.json文件地址](http://dev.poseidon.com/static/wiki/put_order.json)


## 订单取消
### 接口地址
    POST: /mall/order/
### 必要参数

    access_token：access_token,访问令牌
    order_id：订单编号，可以是主订单或者子订单。子订单:一个主订单可能有多个仓库进行发货的，我们将一个主订单进行拆分成多个仓库的子订单

### 例如
```
{
    "access_token": "/oZ%2B%2BmPtgmDPNtr5UP0mBfWq7Sey1Z66L2%2BHG7nRLzAuObp7MyYdp3Sv7Fx33/gvY%2BRskIet1zoleyLqabDuNiWesdEak4FtPJ8KD5M8IVoMMZjbrWmWzTrYa/ucG4e3",
    "order_id": "20160308135616870"
}
```

### 返回数据
#### 请求成功

>注意data中的errcode=0表示操作成功。操作成功没有errmsg信息

```
{
    "code": 200,
    "data": {
    "errcode": 0
    },
    "errMsg": "",
    "innerErrMsg": ""
}
```

#### 请求失败
```
{
    "code": 200,
    "data": {
        "errcode": 73000,
        "errmsg":"有子订单的状态不是待发货,不能取消订单"
    },
    "errMsg": "",
    "innerErrMsg": ""
}
```
## 获取订单列表
### 接口地址
    GET:/mall/order_list/
### 必要的参数
    access_token：access_token,访问令牌
    cur_page：分页器当前请求页
    order_status: 订单状态。包含：
        0 待支付（只创建订单尚但尚未支付）；
        1表示已取消：取消订单(回退销量)；
        3表示待发货：已付款，未发货；
        4表示已发货：已付款，已发货；
        5表示已完成：为已完成状态；
        7表示退款完成：订单状态，对第三方而言并未退款
### 返回数据
#### 请求成功
```
{
    "code": 200,
    "data": {
        "page_info": {
            "max_page": 1,
            "total_count": 1,
            "cur_page": 1
        },
        "orders": [
            {
                "final_price": 7.0,
                "order_id": "20160926165124218",
                "created_at": "2016.09.26 16:51",
                "products": [
                    {
                        "product_id": 12,
                        "price": 1.0,
                        "product_name": "pad1",
                        "product_model_name": "standard",
                        "product_count": 2,
                        "pic_url": "http://chaozhi.weizoom.com/static/upload/20160926/1474871164035_765.jpg"
                    },
                    {
                        "product_id": 10,
                        "price": 10.0,
                        "product_name": "test1product",
                        "product_model_name": "standard",
                        "product_count": 1,
                        "pic_url": "http://chaozhi.weizoom.com/static/upload/20160926/1474871228062_547.jpg"
                    }
                ],
                "product_count": 3,
                "order_status": 4
            }
        ]
    }
}
```

#### 请求失败
```
{
    "code": 200,
    "data": {
        "errcode": 995995,
        "errmsg":"系统自身异常"
    },
    "errMsg": "",
    "innerErrMsg": ""
}
```
### 订单列表返回数据下载
[order_list.json文件地址](http://dev.poseidon.com/static/wiki/order_list.json)
</xmp>
<script src="/static/js/strapdown.js"></script>
</html>